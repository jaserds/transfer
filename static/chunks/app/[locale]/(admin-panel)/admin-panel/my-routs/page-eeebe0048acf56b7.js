(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[403],{8945:(e,t,a)=>{Promise.resolve().then(a.bind(a,3390))},3390:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var s=a(5155),r=a(4085),l=a(2336),o=a(2115);let n=e=>{let{options:t,initialSelected:a=[],onSelectionChange:r}=e,[l,n]=(0,o.useState)(a),i=e=>{let t=l.includes(e)?l.filter(t=>t!==e):[...l,e];n(t),r(t)};return(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsx)("div",{className:"space-y-1",children:t.map(e=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:e.id,checked:l.includes(e.id),onChange:()=>i(e.id),className:"mr-2 text-[#373F47]"}),(0,s.jsx)("label",{htmlFor:e.id,children:e.name})]},e.id))})})};var i=a(745),d=a(2079),c=a(9602);let p=o.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,c.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...r})});p.displayName="Textarea";var u=a(654);let h=(0,a(4057).A)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var m=a(5524);function f(){let[e,t]=(0,o.useState)([]),[a,c]=(0,o.useState)([]),[f,x]=(0,o.useState)(!1),[g,j]=(0,o.useState)([]),[y,b]=(0,o.useState)([]),[N,v]=(0,o.useState)(null),[w,C]=(0,o.useState)([]),[R,k]=(0,o.useState)({inRoute:"",toRoute:"",inRouteEn:"",toRouteEn:"",cityId:"",popularRoute:!1,price:0,pointsGoogleMap:{points:[{lat:0,lng:0},{lat:0,lng:0}]},description:"",descriptionEn:"",transferCarIds:[]}),F=g.map(e=>({id:e.id,name:e.name}));(0,o.useEffect)(()=>{fetch("".concat("http://localhost:3000/api","/city")).then(e=>e.json()).then(c).catch(()=>console.error("Failed to fetch countries")),fetch("".concat("http://localhost:3000/api","/my-routs")).then(e=>e.json()).then(e=>{t(e),C(e.map(e=>({routeId:e.id,transferCarsIds:e.transferCars.map(e=>e.transferCarId)})))}).catch(()=>console.error("Failed to fetch countries")),fetch("".concat("http://localhost:3000/api","/transfer-cars")).then(e=>e.json()).then(e=>{j(e)}).catch(()=>console.error("Failed to fetch countries"))},[]);let I=(e,t)=>{let a=w.filter(e=>e.routeId===t).map(e=>e.transferCarsIds).flat(),s=a.filter(t=>!e.includes(t)),r=e.filter(e=>!a.includes(e));if(C(w.map(a=>a.routeId===t?{...a,transferCarsIds:e}:a)),r.length>0){fetch("".concat("http://localhost:3000/api","/my-routs/add-transfer-car"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({addedId:r[0],routeId:t})}).then(e=>e.json()).catch(()=>console.error("Failed to fetch countries"));return}if(s.length>0){fetch("".concat("http://localhost:3000/api","/my-routs/delete-transfer-car"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({routeId:t,deletedId:s[0]})}).then(e=>e.json());return}},E=async()=>{if(!N)return null;let e=new FormData;e.append("file",N);try{let t=await fetch("".concat("http://localhost:3000/api","/upload"),{method:"POST",body:e});if(!t.ok)throw Error("Image upload failed");return(await t.json()).imageUrl}catch(e){return console.error(e),null}},A=()=>{k({inRoute:"",toRoute:"",inRouteEn:"",toRouteEn:"",cityId:"",price:0,popularRoute:!1,pointsGoogleMap:{points:[{lat:0,lng:0},{lat:0,lng:0}]},description:"",descriptionEn:"",transferCarIds:[]})},M=async()=>{if(!a||!N||!R.cityId||!R.inRoute||!R.toRoute||!y)return;let s=await E();if(s)try{let a=await fetch("".concat("http://localhost:3000/api","/my-routs"),{method:"POST",body:JSON.stringify({...R,pointsGoogleMap:JSON.stringify(R.pointsGoogleMap),imageUrl:s,transferCarIds:R.transferCarIds}),headers:{"Content-Type":"application/json"}});if(!a.ok)throw Error("Failed to add new-route");let r=await a.json();t([...e,r]),A(),v(null),x(!1)}catch(e){console.error(e)}},S=async a=>{try{let s=await fetch("".concat("http://localhost:3000/api","/my-routs/").concat(a),{method:"DELETE"});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to delete route")}t(e.filter(e=>e.id!==a))}catch(e){console.error("Error deleting country:",e)}},T=async(a,s)=>{try{let r=await fetch("".concat("http://localhost:3000/api","/my-routs/").concat(a,"/set-popular-route"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({popularRoute:s})});if(!r.ok)throw Error("Failed to update");let l=await r.json();t(e.map(e=>e.id===a?l:e))}catch(e){console.error(e)}};return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("div",{className:"mb-3 text-[#373F47] font-bold",children:"Добавить маршрут"}),(0,s.jsx)(r.$,{className:"mb-8",onClick:()=>{x(!0)},children:"Добавить"}),f&&(0,s.jsx)("div",{className:"absolute top-0 right-0 bottom-0 left-0 bg-[#00000085] z-20 flex justify-center items-center",children:(0,s.jsxs)("div",{className:"z-30 bg-white p-4 max-w-[450px] max-h-[500px] rounded-[10px] flex flex-col gap-4 pb-16 overflow-y-auto custom-scroll",children:[(0,s.jsx)("button",{onClick:()=>{A(),v(null),x(!1)},className:"cursor-pointer text-[#f02f2f] self-end",children:(0,s.jsx)(u.A,{})}),(0,s.jsx)("div",{className:"mb-3 text-[#373F47] font-bold self-center",children:"Добавить новый маршрут"}),(0,s.jsxs)(i.l6,{onValueChange:e=>k(t=>({...t,cityId:e})),children:[(0,s.jsx)(i.bq,{className:"w-full",children:(0,s.jsx)(i.yv,{placeholder:"Укажите город"})}),(0,s.jsx)(i.gC,{children:a.map(e=>(0,s.jsx)(i.eb,{value:e.id,children:e.name},e.id))})]}),(0,s.jsx)(l.p,{onChange:e=>k(t=>({...t,inRoute:e.target.value})),id:"inRoute",type:"text",className:"",placeholder:"От куда"}),(0,s.jsx)(l.p,{onChange:e=>k(t=>({...t,toRoute:e.target.value})),id:"toRoute",type:"text",className:"",placeholder:"Куда"}),(0,s.jsx)(l.p,{onChange:e=>k(t=>({...t,inRouteEn:e.target.value})),id:"inRouteEn",type:"text",className:"",placeholder:"От куда En"}),(0,s.jsx)(l.p,{onChange:e=>k(t=>({...t,toRouteEn:e.target.value})),id:"toRouteEn",type:"text",className:"",placeholder:"Куда En"}),(0,s.jsx)(l.p,{onChange:e=>k(t=>({...t,price:Number(e.target.value)})),id:"price",type:"text",className:"",placeholder:"Цена"}),(0,s.jsxs)("div",{className:" flex flex-col gap-4 mt-3",children:[(0,s.jsx)("p",{className:"text-[#373F47] font-bold text-center",children:"Точки маршрута для Googl карты"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(l.p,{onChange:e=>k(t=>({...t,pointsGoogleMap:{...t.pointsGoogleMap,points:t.pointsGoogleMap.points.map((t,a)=>0===a?{...t,lat:parseFloat(e.target.value)||0}:t)}})),id:"lat1",type:"text",className:"",placeholder:"lat1 - точка маршрута"}),(0,s.jsx)(l.p,{onChange:e=>k(t=>({...t,pointsGoogleMap:{...t.pointsGoogleMap,points:t.pointsGoogleMap.points.map((t,a)=>0===a?{...t,lng:parseFloat(e.target.value)||0}:t)}})),id:"lng1",type:"text",className:"",placeholder:"lng1 - точка маршрута"})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(l.p,{onChange:e=>k(t=>({...t,pointsGoogleMap:{...t.pointsGoogleMap,points:t.pointsGoogleMap.points.map((t,a)=>1===a?{...t,lat:parseFloat(e.target.value)||0}:t)}})),id:"lat2",type:"text",className:"",placeholder:"lat2 - точка маршрута"}),(0,s.jsx)(l.p,{onChange:e=>k(t=>({...t,pointsGoogleMap:{...t.pointsGoogleMap,points:t.pointsGoogleMap.points.map((t,a)=>1===a?{...t,lng:parseFloat(e.target.value)||0}:t)}})),id:"lng2",type:"text",className:"",placeholder:"lng2 - точка маршрута"})]})]}),(0,s.jsx)("p",{className:"text-[#373F47] font-bold text-center mt-3",children:"Описание маршрута"}),(0,s.jsx)(p,{onChange:e=>k(t=>({...t,description:e.target.value})),placeholder:"Введите описание маршрута"}),(0,s.jsx)(p,{onChange:e=>k(t=>({...t,descriptionEn:e.target.value})),placeholder:"Описание маршрута En"}),(0,s.jsx)("p",{className:"text-[#373F47] font-bold text-center mt-3",children:"Фото для стрицы"}),(0,s.jsx)(l.p,{className:"cursor-pointer",type:"file",onChange:e=>{var t;return v((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}}),(0,s.jsx)("p",{className:"text-[#373F47] font-bold text-center mt-3",children:"Авто"}),(0,s.jsx)(n,{options:F,onSelectionChange:e=>{b(e),k({...R,transferCarIds:e})}}),(0,s.jsx)(r.$,{className:"mt-3",onClick:()=>{M()},children:"Сохранить маршрут"})]})}),(0,s.jsxs)(d.XI,{children:[(0,s.jsx)(d.A0,{children:(0,s.jsxs)(d.Hj,{children:[(0,s.jsx)(d.nd,{className:"px-6",children:"От куда"}),(0,s.jsx)(d.nd,{className:"px-6"}),(0,s.jsx)(d.nd,{className:"px-6",children:"Куда"}),(0,s.jsx)(d.nd,{className:"px-6",children:"Город"}),(0,s.jsx)(d.nd,{className:"px-6",children:"Популярный маршрут?"}),(0,s.jsx)(d.nd,{className:"px-6",children:"Классы авто"}),(0,s.jsx)(d.nd,{className:"px-6"})]})}),(0,s.jsx)(d.BF,{children:e.map(e=>{var t;return(0,s.jsxs)(d.Hj,{children:[(0,s.jsx)(d.nA,{className:"px-6",children:e.inRoute}),(0,s.jsx)(d.nA,{className:"px-6",children:(0,s.jsx)(h,{className:"text-[#c0c0c0]",strokeWidth:1})}),(0,s.jsx)(d.nA,{className:"px-6",children:e.toRoute}),(0,s.jsx)(d.nA,{className:"px-6",children:e.cityId&&(null===(t=a.find(t=>t.id===e.cityId))||void 0===t?void 0:t.name)}),(0,s.jsx)(d.nA,{className:"flex justify-center px-6",children:e.popularRoute?(0,s.jsx)("div",{className:"cursor-pointer",onClick:()=>T(e.id,!e.popularRoute),children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"#FFE6B8",stroke:"#F9AC1A",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-star",children:(0,s.jsx)("path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"})})}):(0,s.jsx)("div",{className:"cursor-pointer",onClick:()=>T(e.id,!e.popularRoute),children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#6C7C8C",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-star hover:fill-[#FFE6B8] hover:stroke-[#F9AC1A]",children:(0,s.jsx)("path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"})})})}),(0,s.jsx)(d.nA,{className:"px-6",children:(0,s.jsx)(n,{options:F,initialSelected:w.filter(t=>t.routeId===e.id).map(e=>e.transferCarsIds).flat(),onSelectionChange:t=>I(t,e.id)})}),(0,s.jsx)(d.nA,{className:"px-6",children:(0,s.jsx)(m.A,{onClick:()=>{S(e.id)},className:"cursor-pointer text-[#6C7C8C] hover:text-rose-500"})})]},e.id)})})]})]})}},4085:(e,t,a)=>{"use strict";a.d(t,{$:()=>d});var s=a(5155),r=a(2115),l=a(2317),o=a(1027),n=a(9602);let i=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:a,variant:r,size:o,asChild:d=!1,...c}=e,p=d?l.DX:"button";return(0,s.jsx)(p,{className:(0,n.cn)(i({variant:r,size:o,className:a})),ref:t,...c})});d.displayName="Button"},2336:(e,t,a)=>{"use strict";a.d(t,{p:()=>o});var s=a(5155),r=a(2115),l=a(9602);let o=r.forwardRef((e,t)=>{let{className:a,type:r,...o}=e;return(0,s.jsx)("input",{type:r,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...o})});o.displayName="Input"},745:(e,t,a)=>{"use strict";a.d(t,{bq:()=>u,eb:()=>x,gC:()=>f,l6:()=>c,yv:()=>p});var s=a(5155),r=a(2115),l=a(4140),o=a(2645),n=a(2488),i=a(7193),d=a(9602);let c=l.bL;l.YJ;let p=l.WT,u=r.forwardRef((e,t)=>{let{className:a,children:r,...n}=e;return(0,s.jsxs)(l.l9,{ref:t,className:(0,d.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[r,(0,s.jsx)(l.In,{asChild:!0,children:(0,s.jsx)(o.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=l.l9.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})});h.displayName=l.PP.displayName;let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(o.A,{className:"h-4 w-4"})})});m.displayName=l.wn.displayName;let f=r.forwardRef((e,t)=>{let{className:a,children:r,position:o="popper",...n}=e;return(0,s.jsx)(l.ZL,{children:(0,s.jsxs)(l.UC,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:o,...n,children:[(0,s.jsx)(h,{}),(0,s.jsx)(l.LM,{className:(0,d.cn)("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(m,{})]})})});f.displayName=l.UC.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.JU,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",a),...r})}).displayName=l.JU.displayName;let x=r.forwardRef((e,t)=>{let{className:a,children:r,...o}=e;return(0,s.jsxs)(l.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...o,children:[(0,s.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(l.VF,{children:(0,s.jsx)(i.A,{className:"h-4 w-4"})})}),(0,s.jsx)(l.p4,{children:r})]})});x.displayName=l.q7.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=l.wv.displayName},2079:(e,t,a)=>{"use strict";a.d(t,{A0:()=>n,BF:()=>i,Hj:()=>d,XI:()=>o,nA:()=>p,nd:()=>c});var s=a(5155),r=a(2115),l=a(9602);let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",a),...r})})});o.displayName="Table";let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",a),...r})});n.displayName="TableHeader";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",a),...r})});i.displayName="TableBody",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});d.displayName="TableRow";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("th",{ref:t,className:(0,l.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...r})});c.displayName="TableHead";let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("td",{ref:t,className:(0,l.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...r})});p.displayName="TableCell",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption"},9602:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(3463),r=a(9795);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},654:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(4057).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[4129,4770,8296,8441,1517,7358],()=>t(8945)),_N_E=e.O()}]);