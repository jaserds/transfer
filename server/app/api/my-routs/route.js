(()=>{var e={};e.id=7298,e.ids=[7298],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},11723:e=>{"use strict";e.exports=require("querystring")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},77598:e=>{"use strict";e.exports=require("node:crypto")},10447:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>g,routeModule:()=>d,serverHooks:()=>E,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>f});var s={};t.r(s),t.d(s,{GET:()=>p,POST:()=>l});var n=t(42706),i=t(28203),o=t(45994),a=t(71618),u=t(77510),c=t(39187);async function p(){try{let e=await a.z.route.findMany({include:{transferCars:{include:{transferCar:!0}}}});return c.NextResponse.json(e)}catch(e){return c.NextResponse.json({error:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function l(e){let r=await (0,u.i)();if(!r||"ADMIN"!==r.user.role)return c.NextResponse.json({error:"Access denied"},{status:403});try{let{imageUrl:r,inRoute:t,toRoute:s,cityId:n,popularRoute:i,pointsGoogleMap:o,description:u,price:p,transferCarIds:l,inRouteEn:d,toRouteEn:x,descriptionEn:f}=await e.json();if(!r||!t||!s||!n||!o||!u||!p||!l||!d||!x||!f)return c.NextResponse.json({error:"Not all fields were filled (imageUrl, inRoute, toRoute, cityId, pointsGoogleMap, description)"},{status:400});let E=await a.z.route.create({data:{imageUrl:r,inRoute:t,toRoute:s,cityId:n,popularRoute:i,pointsGoogleMap:o,description:u,price:p,transferCars:{create:l.map(e=>({transferCar:{connect:{id:e}}}))},RouteTranslation:{create:[{locale:"ru",inRoute:t,toRoute:s,description:u},{locale:"en",inRoute:d,toRoute:x,description:f}]}},include:{transferCars:{include:{transferCar:!0}}}});return c.NextResponse.json(E)}catch(e){return c.NextResponse.json({error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/my-routs/route",pathname:"/api/my-routs",filename:"route",bundlePath:"app/api/my-routs/route"},resolvedPagePath:"C:\\Users\\TurckDrive-PC2\\Desktop\\transfer\\transfer\\app\\api\\my-routs\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:f,serverHooks:E}=d;function g(){return(0,o.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:f})}},96487:()=>{},78335:()=>{},15631:(e,r,t)=>{"use strict";t.d(r,{S:()=>g});var s=t(46814),n=t(28053),i=t(3896),o=t(30379);let a=o.z.object({GITHUB_ID:o.z.string().optional(),GITHUB_SECRET:o.z.string().optional(),GOOGLE_CLIENT_ID:o.z.string().optional(),GOOGLE_SECRET:o.z.string().optional()}).parse(process.env),u={USER:"USER"};var c=t(4502);let p=()=>(0,c.sX)();var l=t(71618);class d{async createUser(e){return await l.z.user.create({data:{...e,role:e.role}})}}let x=new d;class f{async exec(e){let r=u.USER,t={id:p(),role:r,...e};return await x.createUser(t),t}}let E=new f,g={adapter:{...(0,s.y)(l.z),createUser:e=>E.exec(e)},callbacks:{session:async({session:e,user:r})=>({...e,user:{...e.user,id:r.id,role:r.role}})},pages:{signIn:"/en/auth/signin"},providers:(0,i.A)([a.GOOGLE_CLIENT_ID&&a.GOOGLE_SECRET&&(0,n.A)({clientId:a.GOOGLE_CLIENT_ID,clientSecret:a.GOOGLE_SECRET})])}},71618:(e,r,t)=>{"use strict";t.d(r,{z:()=>s});let s=new(require("@prisma/client")).PrismaClient},77510:(e,r,t)=>{"use strict";t.d(r,{i:()=>o});var s=t(51825),n=t(15631);let i=()=>(0,s.getServerSession)(n.S),o=async()=>{let e=await i();if(null===e)throw Error("User is not logged in");return e}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,4512,9187,7206,9719],()=>t(10447));module.exports=s})();