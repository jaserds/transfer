(()=>{var e={};e.id=9071,e.ids=[9071],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},12412:e=>{"use strict";e.exports=require("assert")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},33873:e=>{"use strict";e.exports=require("path")},11723:e=>{"use strict";e.exports=require("querystring")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},74075:e=>{"use strict";e.exports=require("zlib")},77598:e=>{"use strict";e.exports=require("node:crypto")},26204:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>w,routeModule:()=>E,serverHooks:()=>q,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>R});var s={};t.r(s),t.d(s,{DELETE:()=>g,GET:()=>y});var i=t(42706),n=t(28203),o=t(45994),u=t(71618),a=t(39187),c=t(29021),p=t.n(c),l=t(33873),d=t.n(l),x=t(77510);async function y(e,{params:r}){try{let{id:e}=await r;if(!e)return a.NextResponse.json({error:"countryId is required"},{status:400});let t=(await u.z.city.findMany({where:{countryId:e},include:{country:{select:{name:!0}},routes:{select:{id:!0,inRoute:!0,toRoute:!0}},_count:{select:{routes:!0}}}})).map(e=>({countryName:e.country.name,data:{id:e.id,name:e.name,imageUrl:e.imageUrl,countryId:e.countryId,routeCount:e._count.routes,routes:e.routes.map(e=>({id:e.id,inRoute:e.inRoute,toRoute:e.toRoute}))}}));return a.NextResponse.json(t)}catch(e){return a.NextResponse.json({error:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function g(e,{params:r}){let t=await (0,x.i)();if(!t||"ADMIN"!==t.user.role)return a.NextResponse.json({error:"Access denied"},{status:403});try{let{id:e}=await r;if(!e)return a.NextResponse.json({error:"Country ID is required"},{status:400});let t=await u.z.city.findUnique({where:{id:e}});if(!t)return a.NextResponse.json({error:"Country not found"},{status:404});if(t.imageUrl){let e=d().join(process.cwd(),"public",t.imageUrl);p().existsSync(e)&&p().unlinkSync(e)}return await u.z.city.delete({where:{id:e}}),a.NextResponse.json({message:"Country and image deleted successfully"})}catch(e){return console.error("Error deleting country:",e),a.NextResponse.json({error:"Failed to delete country"},{status:500})}}let E=new i.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/city/[id]/route",pathname:"/api/city/[id]",filename:"route",bundlePath:"app/api/city/[id]/route"},resolvedPagePath:"C:\\Users\\TurckDrive-PC2\\Desktop\\transfer\\transfer\\app\\api\\city\\[id]\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:R,serverHooks:q}=E;function w(){return(0,o.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:R})}},96487:()=>{},78335:()=>{},15631:(e,r,t)=>{"use strict";t.d(r,{S:()=>E});var s=t(46814),i=t(28053),n=t(3896),o=t(30379);let u=o.z.object({GITHUB_ID:o.z.string().optional(),GITHUB_SECRET:o.z.string().optional(),GOOGLE_CLIENT_ID:o.z.string().optional(),GOOGLE_SECRET:o.z.string().optional()}).parse(process.env),a={USER:"USER"};var c=t(4502);let p=()=>(0,c.sX)();var l=t(71618);class d{async createUser(e){return await l.z.user.create({data:{...e,role:e.role}})}}let x=new d;class y{async exec(e){let r=a.USER,t={id:p(),role:r,...e};return await x.createUser(t),t}}let g=new y,E={adapter:{...(0,s.y)(l.z),createUser:e=>g.exec(e)},callbacks:{session:async({session:e,user:r})=>({...e,user:{...e.user,id:r.id,role:r.role}})},pages:{signIn:"/en/auth/signin"},providers:(0,n.A)([u.GOOGLE_CLIENT_ID&&u.GOOGLE_SECRET&&(0,i.A)({clientId:u.GOOGLE_CLIENT_ID,clientSecret:u.GOOGLE_SECRET})])}},71618:(e,r,t)=>{"use strict";t.d(r,{z:()=>s});let s=new(require("@prisma/client")).PrismaClient},77510:(e,r,t)=>{"use strict";t.d(r,{i:()=>o});var s=t(51825),i=t(15631);let n=()=>(0,s.getServerSession)(i.S),o=async()=>{let e=await n();if(null===e)throw Error("User is not logged in");return e}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,4512,9187,7206,9719],()=>t(26204));module.exports=s})();